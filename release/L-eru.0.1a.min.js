Array.prototype.copy=function(){return this.slice(0)};Array.prototype.copy2=function(){var c=this.length;var b=[];for(var a=0;a<c;a++){if(this[a].isArray){b[a]=this[a].copy2()}}return b.slice(0)};Array.prototype.mapQuick=function(c){var b=this.length;for(var a=0;a<b;a++){c(this[a],a)}};Array.prototype.sortBy=function(e,a){var d=e;var c=this.length;if(a===undefined){a=1}for(var b=0;b<c;b++){if(this[b] instanceof Array){this[b].sortBy(d,a)}}this.sort(function(g,f){return a*(g[d]-f[d])})};Array.prototype.draw=function(a){var c=this.length;for(var b=0;b<c;b++){if(this[b].draw){this[b].draw(a)}}};Array.prototype.update=function(){var b=this.length;for(var a=0;a<b;a++){if(this[a].update){this[a].update()}}};Array.prototype.isClicked=function(c,a){var d=this.length;for(var b=d-1;b>=0;b--){if(this[b].isClicked(c,a)){return true}}};Math.degToRad=function(a){return(a*(Math.PI/180))};Math.radToDeg=function(a){return(a*(180/Math.PI))};Math.vectorX=function(a,b){switch(b){case 0:return a;break;case 180:return -a;break;case 90:case -90:return 0;break;default:return Math.cos(Math.degToRad(b))*a;break}};Math.vectorY=function(a,b){switch(b){case 0:case 180:return 0;break;case 90:return -a;break;case -90:return a;break;default:return Math.sin(Math.degToRad(b))*a;break}};Math.Vector=function(a,b){this.magnitude=a;this.direction=b};Math.Vector.prototype.addVector=function(e){var b=Math.degToRad(this.direction);var a=Math.degToRad(e.direction);var d=Math.cos(b)*this.magnitude;var c=Math.cos(a)*e.magnitude;var k=-Math.sin(b)*this.magnitude;var j=-Math.sin(a)*e.magnitude;var h=d+c;var g=k+j;var i=Math.atan(g/h);var f=Math.sqrt((Math.pow(h,2)+Math.pow(g,2)));this.magnitude=f;this.direction=i};var L={};L.start=function(){window.removeEventListener("load",L.start);var a=new L_Game();a.settings();L.system.setup();a.resources();a.initialise();(function b(){L.system.now=window.performance.now();L.system.dt=(L.system.now-L.system.then)/1000;if(L.system.dt>1/45){L.system.dt=1/45}L.system.then=L.system.now;a.update();a.draw();requestAnimationFrame(b)})()};L.whisper=function(a){console.log(a)};L.shout=function(a){window.alert(a)};L.system={};L.system.timeScale=1;L.system.frameCap=30;L.system.now,L.system.then=window.performance.now();L.system.dt=0;L.system.checkAudio=function(){var a=document.createElement("audio");if(a.canPlayType("audio/wav")){L.system.audioType=".wav";L.whisper("Using .wav files")}else{if(a.canPlayType("audio/mp4")){L.system.audioType=".m4a";L.whisper("Using .m4a files")}else{L.shout("Your browser doesn't support .wav or .m4a files.")}}};(function(){L.system.checkAudio()})();L.system.resourcePath="resources/";L.system.soundPath="sounds/";L.system.texturePath="textures/";L.system.expectedResources=0;L.system.loadedResources=0;L.system.width=640;L.system.height=480;L.system.canvasLocation=document.body;L.system.layerAlpha=1;L.system.currentScene={};L.scenes={};L.texture={};L.load={};L.load.texture=function(a,b){L.system.expectedResources+=1;var c=new Image();c.onload=function(){L.system.loadedResources+=1};c.onerror=function(d){L.shout("Oops! Your browser does not support this audio type.")};c.src=L.system.resourcePath+L.system.texturePath+b;L.texture[a]=c};L.sound={};L.music={};window.addEventListener("load",L.start);window.onunload=function(){L=null};L.system.renderCanvas=[];L.system.renderContext=[];L.system.bufferCanvas=[];L.system.bufferContext=[];L.system.setup=function(){var b=L.system.width;var a=L.system.height;L.system.renderCanvas[0]=document.createElement("canvas");L.system.renderCanvas[0].width=b;L.system.renderCanvas[0].height=a;L.system.canvasLocation.appendChild(L.system.renderCanvas[0]);L.system.renderContext[0]=L.system.renderCanvas[0].getContext("2d");L.system.bufferCanvas[0]=document.createElement("canvas");L.system.bufferCanvas[0].width=b;L.system.bufferCanvas[0].height=a;L.system.bufferContext[0]=L.system.bufferCanvas[0].getContext("2d");L.system.canvasX=L.system.renderCanvas[0].offsetLeft;L.system.canvasY=L.system.renderCanvas[0].offsetTop;L.system.handleClick=function(f){var d=f.pageX-L.system.canvasX;var c=f.pageY-L.system.canvasY;L.system.currentScene.isClicked(d,c)};L.system.renderCanvas[0].addEventListener("click",L.system.handleClick)};L.objects={};L.objects.Scene=function(a){L.scenes[a]=this;this.layers=[]};L.objects.Scene.prototype.update=function(){this.autoUpdate()};L.objects.Scene.prototype.autoUpdate=function(){this.layers.update()};L.objects.Scene.prototype.draw=function(){this.autoDraw()};L.objects.Scene.prototype.autoDraw=function(){this.layers.draw()};L.objects.Scene.prototype.addLayer=function(b){var c=b||1;for(var a=0;a<c;a++){this.layers.push(new L.objects.Layer(L.system.bufferContext[0]))}};L.objects.Scene.prototype.isClicked=function(b,a){this.layers.isClicked(b,a)};L.objects.Layer=function(a){this.sorted=true;this.sortBy=["z"];this.sortOrder=[1];this.objects=[];this.targetContext=a;this.layerAlpha=1;this.isClickable=true};L.objects.Layer.prototype.draw=function(){this.autoDraw()};L.objects.Layer.prototype.autoDraw=function(){this.objects.draw(this.targetContext)};L.objects.Layer.prototype.update=function(){this.autoUpdate()};L.objects.Layer.prototype.autoUpdate=function(){this.objects.mapQuick(function(b){b.update()});if(this.sorted){length=this.sortBy.length;for(var a=0;a<length;a++){this.objects.sortBy(this.sortBy[a],this.sortOrder[a])}}};L.objects.Layer.prototype.isClicked=function(b,a){if(this.isClickable){this.objects.isClicked(b,a)}};L.objects.Layer.prototype.addObject=function(a){this.objects.push(a)};L.objects.Layer.prototype.addObjects=function(c){var a=arguments.length;for(var b=0;b<a;b++){this.addObject(arguments[b])}};L.objects.Sprite=function(a,b){this.animations={};this.animations.idle={};this.animations.idle[0]={img:L.texture[a],length:1000};if(this.animations.idle[0].img){L.whisper('Created Sprite from texture "'+a+'".')}this.x=(b&&b.x)?b.x:0;this.y=(b&&b.y)?b.y:0;this.z=(b&&b.z)?b.z:0;this.width=(b&&b.width)?b.width:this.animations.idle[0].img.width;this.height=(b&&b.height)?b.height:this.animations.idle[0].img.height;this.center={};this.center.x=this.width/2;this.center.y=this.height/2;this.handle={};this.handle.x=(b&&b.handle&&(b.handle.x||b.handle.x===0))?b.handle.x:this.center.x;this.handle.y=(b&&b.handle&&(b.handle.y||b.handle.y===0))?b.handle.y:this.center.y;this.offset={};this.offset.x=0;this.offset.y=0;this.nudeTop=0-this.handle.y;this.nudeLeft=0-this.handle.x;this.nudeRight=this.nudeLeft+this.width;this.nudeBottom=this.nudeTop+this.height;this.nudeTopLeft=[this.nudeLeft,this.nudeTop];this.nudeTopRight=[this.nudeRight,this.nudeTop];this.nudeBottomLeft=[this.nudeLeft,this.nudeBottom];this.nudeBottomRight=[this.nudeRight,this.nudeBottom];this.nudeVertices=[this.nudeTopLeft,this.nudeTopRight,this.nudeBottomRight,this.nudeBottomLeft];this.vertices=new Array(this.nudeVertices.length);this.angle=(b&&b.angle)?b.angle:0;this.rotation=(b&&b.rotation)?b.rotation:0;this.speedX=0;this.speedY=0;this.accelX=0;this.accelY=0;this.accelDirection=0;this.nextX=this.x;this.nextY=this.y;this.nextSpeedX=this.speedX;this.nextSpeedY=this.speedY;this.wrapX=true;this.wrapY=false;this.boundingType="rect";this.visible=true;this.alpha=(b&&b.alpha)?b.alpha:1;this.blendMode="";this.onClick=function(){alert("click")};this.currentAnimation="idle";this.currentFrame=0;this.animationTimer;this.updateCommands={};this.drawCommands={};this.isClickable=true;this.gravity=0;this.g=1000;this.direction=-Math.PI/2;this.v=0;this.y0=500-this.y;this.energy=this.y0;this.time=0;this.bounces=0;this.landingTime=(this.v*Math.sin(this.direction)+Math.sqrt(Math.pow((this.v*Math.sin(this.direction)),2)+(2*this.g*this.y0)))/this.g};L.objects.Sprite.prototype.draw=function(a){this.autoDraw(a)};L.objects.Sprite.prototype.autoDraw=function(a){a.globalAlpha=this.alpha;if(this.alpha>0&&this.visible){if(this.angle!==0){var b=this.angle;a.save();a.translate(this.x,this.y);a.rotate(-b);a.drawImage(this.animations.idle[this.currentFrame].img,-this.handle.x,-this.handle.y);a.restore()}else{a.drawImage(this.animations.idle[this.currentFrame].img,this.x-this.handle.x,this.y-this.handle.y)}}};L.objects.Sprite.prototype.drawBoundingBox=function(b){b.beginPath();this.getVertices();b.moveTo(this.vertices[3][0],this.vertices[3][1]);for(var a=0;a<4;a++){b.lineTo(this.vertices[a][0],this.vertices[a][1])}b.closePath();b.strokeStyle="#FFFFFF";b.lineWidth=2;b.stroke()};L.objects.Sprite.prototype.update=function(){this.autoUpdate()};L.objects.Sprite.prototype.autoUpdate=function(){this.speedX+=this.accelX*L.system.dt*L.system.timeScale;this.speedY+=this.accelY*L.system.dt*L.system.timeScale;this.x+=this.speedX*L.system.dt*L.system.timeScale;this.y+=this.speedY*L.system.dt*L.system.timeScale;this.angle+=this.rotation*L.system.dt*L.system.timeScale};L.objects.Sprite.prototype.experimentalUpdate=function(){this.time+=L.system.dt*L.system.timeScale;if(this.time>=this.landingTime){if(this.energy<1){this.energy=0}this.direction=Math.PI/2;this.y0=0;this.v=Math.sqrt((this.g*2*this.energy)/(Math.pow(Math.sin(this.direction),2)));this.time-=this.landingTime;this.landingTime=(this.v*Math.sin(this.direction)+Math.sqrt(Math.pow((this.v*Math.sin(this.direction)),2)+(2*this.g*this.y0)))/this.g}if(this.landingTime<L.system.dt*L.system.timeScale){this.y=500}else{this.y=500-this.y0-(this.v*Math.sin(this.direction)*this.time-(this.g*this.time*this.time/2))}if(this.y>=500){this.y=500}this.nextY=this.y;this.nextSpeedX+=this.accelX*L.system.dt*L.system.timeScale;this.nextX+=this.nextSpeedX*L.system.dt*L.system.timeScale;if(this.nextX>=800){this.nextSpeedX=-this.speedX;this.speedX=-this.speedX;this.nextX=799}if(this.nextX<=49){this.nextSpeedX=-this.speedX;this.speedX=-this.speedX;this.nextX=50}this.x=(this.nextX);this.speedX=(this.nextSpeedX)};L.objects.Sprite.prototype.isClicked=function(b,a){if(this.isClickable){if((this.angle===0&&b>=this.x+this.offset.x-this.handle.x&&b<=this.x+this.width+this.offset.x-this.handle.x&&a>=this.y+this.offset.y-this.handle.y&&a<=this.y+this.height+this.offset.y-this.handle.y)||(this.angle!==0&&this.jordanCurve(b,a))){this.onClick();return true}}};L.objects.Sprite.prototype.getSpeedX=function(){return Math.vectorX(this.speed,this.direction)};L.objects.Sprite.prototype.getSpeedY=function(){return Math.vectorY(this.speed,this.direction)};L.objects.Sprite.prototype.applyForce=function(d,i){var b=this.getSpeedX();var j=this.getSpeedY();var a=Math.vectorX(d,i);var h=Math.vectorY(d,i);var g=b+a;var f=j+h;var c=Math.pow((Math.pow(g,2)+Math.pow(f,2)),1/2);var e=Math.radToDeg(Math.atan2(-f,g));this.direction=e;this.speed=c};L.objects.Sprite.prototype.moveTo=function(a){this.x=a.x;this.y=a.y};L.objects.Sprite.prototype.moveToX=function(a){this.x=a};L.objects.Sprite.prototype.move=function(a){this.x+=a.x;this.y+=a.y};L.objects.Sprite.prototype.movex=function(a){this.move({x:a,y:0})};L.objects.Sprite.prototype.movey=function(a){this.move({x:0,y:a})};L.objects.Sprite.prototype.getVertices=function(){var a=this.x+this.offset.x;var b=this.y+this.offset.y;if(this.angle!==0){var d=this.nudeVertices.length;for(var c=0;c<d;c++){this.vertices[c]=[this.nudeVertices[c][0]*Math.cos(-this.angle)-this.nudeVertices[c][1]*Math.sin(-this.angle),this.nudeVertices[c][0]*Math.sin(-this.angle)+this.nudeVertices[c][1]*Math.cos(-this.angle)]}}else{for(var c=0;c<d;c++){this.vertices[c]=[this.nudeVertices[c][0],this.nudeVertices[c][0]]}}this.vertices.mapQuick(function(e){e[0]+=a;e[1]+=b});return this.vertices};L.objects.Sprite.prototype.jordanCurve=function(a,f){var e=false;var d=this.vertices.length;this.getVertices();for(var c=0,b=d-1;c<d;b=c++){if((this.vertices[c][1]>f)!==(this.vertices[b][1]>f)){if(a<((this.vertices[b][0]-this.vertices[c][0])*(f-this.vertices[c][1])/(this.vertices[b][1]-this.vertices[c][1])+this.vertices[c][0])){e=!e}}}return e};function pnpoly(b,g,f,a,k){var e,d,h=0;for(e=0,d=b-1;e<b;d=e++){if(((f[e]>k)!==(f[d]>k))&&(a<(g[d]-g[e])*(k-f[e])/(f[d]-f[e])+g[e])){h=!h}}return h}L.Frame=function(a,b){this.img=L.texture[a];this.length=b};L.Animation=function(a){};